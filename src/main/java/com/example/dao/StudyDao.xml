<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.dao.StudyDao">
	<select id="getList" resultType="study">
		SELECT 
				sno, id, sname, 
				content, mname, location, 
				to_char(totime,'YY-MM-DD') as totime, 
				to_char(fromtime,'YY-MM-DD') as fromtime, 
				to_char(sdate,'hh:mm') as sdate, 
				joincode 
		FROM study
	</select>
	
	<select id="getOne" parameterType="long" resultType="Study">
		SELECT  
				sno, id, sname, 
				content, mname, location, 
				to_char(totime,'YY-MM-DD') as totime, 
				to_char(fromtime,'YY-MM-DD') as fromtime, 
				to_char(sdate,'hh:mm') as sdate, 
				joincode
		FROM study
		WHERE sno = #{sno}
	</select>
	
	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*)
		FROM study
	</select>
	

	<insert id="add">
		<selectKey keyProperty="sno" order="BEFORE" resultType="int">
			select coalesce(max(sno+1),1) as sno from study
		</selectKey>
		insert into study (sno, id, sname, content, mname, location, totime, fromtime, sdate, joincode)
		values 
		(#{sno}, #{id}, #{sname}, #{content}, #{mname}, #{location}, #{totime}, #{fromtime}, #{sdate}, #{joincode})
	</insert>
	
	<update id="modify" parameterType="map">
		UPDATE article
		SET title = #{title},
		body = #{body}
		WHERE id = #{id}
	</update>
	
	<update id="hitUp" parameterType="long">
		UPDATE article
		SET hit = hit + 1
		WHERE id = #{id}
	</update>
	
	<delete id="delete" parameterType="long" >
		DELETE FROM article
		WHERE id = #{id}
	</delete>
</mapper>
